(function(n,t){"use strict";typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?t(n,!0):function(n){if(!n.document)throw new Error("Geetest requires a window with a document");return t(n)}:t(n)})(typeof window!="undefined"?window:this,function(n){"use strict";function r(n){this._obj=n}function e(n){var t=this;new r(n)._each(function(n,i){t[n]=i})}var u;if(typeof n=="undefined")throw new Error("Geetest requires browser environment");var f=n.document,c=n.Math,l=f.getElementsByTagName("head")[0];r.prototype={_each:function(n){var t=this._obj;for(var i in t)t.hasOwnProperty(i)&&n(i,t[i]);return this}};e.prototype={api_server:"api.geetest.com",protocol:"http://",type_path:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var n=this;return o(n.type)?n.fallback_config[n.type]:n.new_captcha?n.fallback_config.fullpage:n.fallback_config.slide},_extend:function(n){var t=this;new r(n)._each(function(n,i){t[n]=i})}};var a=function(n){return typeof n=="number"},o=function(n){return typeof n=="string"},v=function(n){return typeof n=="boolean"},y=function(n){return typeof n=="object"&&n!==null},p=function(n){return typeof n=="function"},t={},i={},w=function(){return parseInt(c.random()*1e4)+(new Date).valueOf()},b=function(n,t){var i=f.createElement("script"),r;i.charset="UTF-8";i.async=!0;i.onerror=function(){t(!0)};r=!1;i.onload=i.onreadystatechange=function(){r||i.readyState&&"loaded"!==i.readyState&&"complete"!==i.readyState||(r=!0,setTimeout(function(){t(!1)},0))};i.src=n;l.appendChild(i)},k=function(n){return n.replace(/^https?:\/\/|\/$/g,"")},d=function(n){return n=n.replace(/\/+/g,"/"),n.indexOf("/")!==0&&(n="/"+n),n},g=function(n){if(!n)return"";var t="?";return new r(n)._each(function(n,i){(o(i)||a(i)||v(i))&&(t=t+encodeURIComponent(n)+"="+encodeURIComponent(i)+"&")}),t==="?"&&(t=""),t.replace(/&$/,"")},nt=function(n,t,i,r){t=k(t);var u=d(i)+g(r);return t&&(u=n+t+u),u},s=function(n,t,i,r,u){var f=function(e){var o=nt(n,t[e],i,r);b(o,function(n){n?e>=t.length-1?u(!0):f(e+1):u(!1)})};f(0)},tt=function(t,i,r,u){if(y(r.getLib)){r._extend(r.getLib);u(r);return}if(r.offline){u(r._get_fallback_config());return}var f="geetest_"+w();n[f]=function(t){t.status==="success"?u(t.data):t.status?u(r._get_fallback_config()):u(t);n[f]=undefined;try{delete n[f]}catch(i){}};s(r.protocol,t,i,{gt:r.gt,callback:f},function(n){n&&u(r._get_fallback_config())})},h=function(n,t){var i={networkError:"网络错误"};if(typeof t.onError=="function")t.onError(i[n]);else throw new Error(i[n]);},it=function(){return!!n.Geetest};return it()&&(i.slide="loaded"),u=function(r,u){var f=new e(r);r.https?f.protocol="https://":r.protocol||(f.protocol=n.location.protocol+"//");tt([f.api_server||f.apiserver],f.type_path,f,function(r){var e=r.type,c=function(){f._extend(r);u(new n.Geetest(f))},o;t[e]=t[e]||[];o=i[e]||"init";o==="init"?(i[e]="loading",t[e].push(c),s(f.protocol,r.static_servers||r.domains,r[e]||r.path,null,function(n){var u,r,s,o;if(n)i[e]="fail",h("networkError",f);else{for(i[e]="loaded",u=t[e],r=0,s=u.length;r<s;r=r+1)o=u[r],p(o)&&o();t[e]=[]}})):o==="loaded"?c():o==="fail"?h("networkError",f):o==="loading"&&t[e].push(c)})},n.initGeetest=u,u});